"use strict";

var bcrypt = require("bcrypt");

var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),
	charsLength = chars.length,
	digits = "0123456789".split(""),
	digitsLength = digits.length;

exports.createHash = function(password) {
	var salt = bcrypt.genSaltSync(10);
	return bcrypt.hashSync(password, salt);
};

exports.check = function(password, hash) {
	return bcrypt.compareSync(password, hash);
};

exports.generate = function() {
	var index, password = "";
	for(var i = 0; i < 7; i++) {
		index = Math.floor(Math.random() * charsLength);
		password += chars[index];
	}
	return password;
};

exports.generateDigital = function() {
	var index, password = "";
	for(var i = 1; i < 9; i++) {
		if(i % 3) {
			index = Math.floor(Math.random() * digitsLength);
			password += digits[index];
		} else {
			password += " ";
		}
	}
	return password;
};

exports.generateCode = function() {
	var index, password = "";
	for(var i = 0; i < 3; i++) {
		index = Math.floor(Math.random() * digitsLength);
		password += digits[index];
	}
	return password;
};